# Copy to .env and fill values per room.
ROOM_ID=room1

# Compose stack identity.
# - Primary: set STACK_ID=${ROOM_ID} (or ${ROOM_ID}_primary)
# - Standby: set STACK_ID=${ROOM_ID}_standby
# This prevents container/network name collisions when running primary + standby on the same host.
STACK_ID=room1

# External ports (optional; map unique host ports per room if needed)
# Bind IPs are the preferred way to avoid port conflicts across multiple rooms.
# Example (per-room VLAN interfaces): MQTT_BIND_IP=10.10.1.2, DB_BIND_IP=10.10.1.2
MQTT_BIND_IP=0.0.0.0
MQTT_PORT=1883
DB_BIND_IP=0.0.0.0
DB_PORT=5432

# MQTT auth (shared across controllers in the room)
MQTT_USERNAME=sentient
MQTT_PASSWORD=changeme

# External DNS name controllers use to reach this room broker.
# Example: mqtt.clockwork.sentientengine.ai
MQTT_PUBLIC_HOSTNAME=mqtt.<room>.sentientengine.ai

# Secrets (placeholder; do not commit real values)
POSTGRES_PASSWORD=changeme

# SCS / OSC
SCS_HOST=10.0.0.10
SCS_OSC_PORT=53000

# Dev-only: if running the included `scs-sim` container, set:
# SCS_HOST=scs-sim

# osc-bridge reliability knobs (retries on UDP send error)
OSC_RETRIES=5
OSC_RETRY_BASE_MS=200

# Optional notifications: webhook URL for `sentient-notify` to POST CoreFault events.
# Example: https://hooks.slack.com/services/...
NOTIFY_WEBHOOK_URL=

# Notify: core status watchdog (ms). Core publishes retained core/status every ~1s.
NOTIFY_CORE_STATUS_TIMEOUT_MS=5000
# Startup grace period before core-status watchdog starts alerting (ms).
NOTIFY_STARTUP_GRACE_MS=15000

# Room-scoped HTTP API (for GM/Tech controls; used by future UIs).
# Bind to the room VLAN IP to avoid conflicts across rooms.
API_BIND_IP=0.0.0.0
API_PORT=8080
# Optional: reverse proxy hostname for this room API (admin LAN / internal DNS).
# Example: api.clockwork.sentientengine.ai
API_PUBLIC_HOSTNAME=api.<room>.sentientengine.ai
# Optional: protect API with a bearer token (Authorization: Bearer <token>)
API_TOKEN=

# Safety / runtime
DRY_RUN=false

# Core command dispatch gate. For warm-standby stacks, start with false.
CORE_DISPATCH_ENABLED=true

# Optional: protect the core MQTT control plane (`room/<room>/core/control`) with a shared token.
# If set, `sentient-api` will include it automatically when publishing control requests.
CORE_CONTROL_TOKEN=

# Extra safety: CRITICAL commands require this to be true (defaults false).
CORE_CRITICAL_ARMED=false

# DB persistence (room-local TimescaleDB). If the DB is down, core will continue without persistence.
CORE_DB_ENABLED=true

# Optional: device registry overrides (JSON map device_id -> "CRITICAL" | "NON_CRITICAL").
# DB `devices` table is preferred and overrides this when present.
DEVICE_SAFETY_CLASS_JSON=

# Dev-only: controller-sim safety injection (for testing safety latch/reset)
SIM_SAFETY_KIND=SAFE
SIM_SAFETY_LATCHED=false
SIM_SAFETY_REASON_CODE=
# If set (>0), controller-sim starts SAFE then flips to SIM_SAFETY_KIND after N ms.
SIM_TRIGGER_FAULT_AFTER_MS=0
